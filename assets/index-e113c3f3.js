var ee=Object.defineProperty;var te=(e,t,r)=>t in e?ee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var u=(e,t,r)=>(te(e,typeof t!="symbol"?t+"":t,r),r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();const c={degreesToRadians:function(e){return e*Math.PI/180},radiansToDegrees:function(e){return e*180/Math.PI},colors:{red:[1,0,0,1],blue:[0,1,0,1],green:[0,0,1,1],black:[0,0,0,1],white:[1,1,1,1]}};function re(e,t,r){const i=e.createBuffer({size:r,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),n=e.createBindGroup({layout:t.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:i}}]});return{uniformBuffer:i,uniformBindGroup:n}}class ie{constructor(){u(this,"definition",{position:new Float32Array([]),color:new Float32Array([]),uv:new Float32Array([])});u(this,"positionBuffer",null);u(this,"colorBuffer",null);u(this,"uvBuffer",null);u(this,"uniformBuffer",null);u(this,"uniformBindGroup",null);u(this,"position",{x:0,y:0,z:0});u(this,"rotation",{x:0,y:0,z:0});u(this,"scale",{x:1,y:1,z:1})}add(t){this.positionBuffer=t.device.createBuffer({size:this.definition.position.byteLength*4,usage:GPUBufferUsage.VERTEX,mappedAtCreation:!0}),this.colorBuffer=t.device.createBuffer({size:this.definition.color.byteLength*4,usage:GPUBufferUsage.VERTEX,mappedAtCreation:!0}),this.uvBuffer=t.device.createBuffer({size:this.definition.uv.byteLength*4,usage:GPUBufferUsage.VERTEX,mappedAtCreation:!0}),new Float32Array(this.positionBuffer.getMappedRange()).set(this.definition.position),new Float32Array(this.colorBuffer.getMappedRange()).set(this.definition.color),new Float32Array(this.uvBuffer.getMappedRange()).set(this.definition.uv),this.positionBuffer.unmap(),this.colorBuffer.unmap(),this.uvBuffer.unmap();const{uniformBuffer:r,uniformBindGroup:i}=re(t.device,t.pipeline,t.bufferSize);this.uniformBuffer=r,this.uniformBindGroup=i}resize(t){this.scale.x=t,this.scale.y=t,this.scale.z=t}draw(t,r,i,n){if(this.uniformBuffer==null)throw new Error("Shape was not added to any scene");const o=new Float32Array(n/4);o.set(t.matrix),o.set([this.position.x,this.position.y,this.position.z,1],16),o.set([this.rotation.x,this.rotation.y,this.rotation.z],20),o.set([this.scale.x,this.scale.y,this.scale.z],24),r.queue.writeBuffer(this.uniformBuffer,0,o),i.setBindGroup(0,this.uniformBindGroup),i.setVertexBuffer(0,this.positionBuffer),i.setVertexBuffer(1,this.colorBuffer),i.setVertexBuffer(2,this.uvBuffer),i.draw(this.positionBuffer.size/16,1,0,0)}}const ne={position:new Float32Array([-.5,-.5,-.5,1,-.5,.5,-.5,1,.5,-.5,-.5,1,.5,.5,-.5,1,.5,-.5,-.5,1,-.5,.5,-.5,1,-.5,-.5,.5,1,.5,-.5,.5,1,-.5,.5,.5,1,.5,.5,.5,1,-.5,.5,.5,1,.5,-.5,.5,1,-.5,.5,-.5,1,-.5,.5,.5,1,.5,.5,-.5,1,.5,.5,-.5,1,-.5,.5,.5,1,.5,.5,.5,1,-.5,-.5,-.5,1,.5,-.5,-.5,1,-.5,-.5,.5,1,-.5,-.5,.5,1,.5,-.5,-.5,1,.5,-.5,.5,1,-.5,-.5,-.5,1,-.5,-.5,.5,1,-.5,.5,-.5,1,-.5,.5,-.5,1,-.5,-.5,.5,1,-.5,.5,.5,1,.5,-.5,.5,1,.5,-.5,-.5,1,.5,.5,-.5,1,.5,.5,-.5,1,.5,.5,.5,1,.5,-.5,.5,1]),color:new Float32Array([...c.colors.white,...c.colors.blue,...c.colors.red,...c.colors.green,...c.colors.red,...c.colors.blue,...c.colors.white,...c.colors.red,...c.colors.blue,...c.colors.green,...c.colors.blue,...c.colors.red,...c.colors.blue,...c.colors.blue,...c.colors.green,...c.colors.green,...c.colors.blue,...c.colors.green,...c.colors.white,...c.colors.red,...c.colors.white,...c.colors.white,...c.colors.red,...c.colors.red,...c.colors.white,...c.colors.white,...c.colors.blue,...c.colors.blue,...c.colors.white,...c.colors.blue,...c.colors.red,...c.colors.red,...c.colors.green,...c.colors.green,...c.colors.green,...c.colors.red]),uv:new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])};class N extends ie{constructor(){super(),this.definition=ne}}function oe(){let e="",t=!0;navigator.gpu||(t=!1,e=`Your current browser does not support WebGPU! Make sure you are on a system 
        with WebGPU enabled. Currently, WebGPU is supported in  
        <a href="https://www.google.com/chrome">Chrome 113+</a>
        (On Linux and Android, enable the <a href="chrome://flags/#enable-unsafe-webgpu">chrome://flags/#enable-unsafe-webgpu</a> flag)
        and <a href="https://developer.apple.com/safari/resources/">Safari Technology Preview</a>. See the 
        <a href="https://github.com/gpuweb/gpuweb/wiki/Implementation-Status"> 
        Implementation Status</a> page for more details.   
        `);const r=document.getElementById("canvas-webgpu");if(r){const i=document.getElementById("app");if(i){let n=function(){r.width=i.offsetWidth,r.height=i.offsetHeight};r.width=i.offsetWidth,r.height=i.offsetHeight,window.addEventListener("resize",n)}}return[e,t]}var U=1e-6,M=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function se(){var e=new M(9);return M!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function C(){var e=new M(16);return M!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function ae(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ce(e,t,r){var i=t[0],n=t[1],o=t[2],s=t[3],a=t[4],f=t[5],w=t[6],m=t[7],g=t[8],y=t[9],l=t[10],B=t[11],x=t[12],z=t[13],F=t[14],I=t[15],h=r[0],d=r[1],v=r[2],p=r[3];return e[0]=h*i+d*a+v*g+p*x,e[1]=h*n+d*f+v*y+p*z,e[2]=h*o+d*w+v*l+p*F,e[3]=h*s+d*m+v*B+p*I,h=r[4],d=r[5],v=r[6],p=r[7],e[4]=h*i+d*a+v*g+p*x,e[5]=h*n+d*f+v*y+p*z,e[6]=h*o+d*w+v*l+p*F,e[7]=h*s+d*m+v*B+p*I,h=r[8],d=r[9],v=r[10],p=r[11],e[8]=h*i+d*a+v*g+p*x,e[9]=h*n+d*f+v*y+p*z,e[10]=h*o+d*w+v*l+p*F,e[11]=h*s+d*m+v*B+p*I,h=r[12],d=r[13],v=r[14],p=r[15],e[12]=h*i+d*a+v*g+p*x,e[13]=h*n+d*f+v*y+p*z,e[14]=h*o+d*w+v*l+p*F,e[15]=h*s+d*m+v*B+p*I,e}function fe(e,t,r,i,n){var o=1/Math.tan(t/2),s;return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,n!=null&&n!==1/0?(s=1/(i-n),e[10]=(n+i)*s,e[14]=2*n*i*s):(e[10]=-1,e[14]=-2*i),e}var le=fe;function ue(e,t,r,i){var n,o,s,a,f,w,m,g,y,l,B=t[0],x=t[1],z=t[2],F=i[0],I=i[1],h=i[2],d=r[0],v=r[1],p=r[2];return Math.abs(B-d)<U&&Math.abs(x-v)<U&&Math.abs(z-p)<U?ae(e):(m=B-d,g=x-v,y=z-p,l=1/Math.hypot(m,g,y),m*=l,g*=l,y*=l,n=I*y-h*g,o=h*m-F*y,s=F*g-I*m,l=Math.hypot(n,o,s),l?(l=1/l,n*=l,o*=l,s*=l):(n=0,o=0,s=0),a=g*s-y*o,f=y*n-m*s,w=m*o-g*n,l=Math.hypot(a,f,w),l?(l=1/l,a*=l,f*=l,w*=l):(a=0,f=0,w=0),e[0]=n,e[1]=a,e[2]=m,e[3]=0,e[4]=o,e[5]=f,e[6]=g,e[7]=0,e[8]=s,e[9]=w,e[10]=y,e[11]=0,e[12]=-(n*B+o*x+s*z),e[13]=-(a*B+f*x+w*z),e[14]=-(m*B+g*x+y*z),e[15]=1,e)}function b(){var e=new M(3);return M!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function he(e){var t=e[0],r=e[1],i=e[2];return Math.hypot(t,r,i)}function P(e,t,r){var i=new M(3);return i[0]=e,i[1]=t,i[2]=r,i}function de(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function S(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function E(e,t){var r=t[0],i=t[1],n=t[2],o=r*r+i*i+n*n;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}function ve(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function A(e,t,r){var i=t[0],n=t[1],o=t[2],s=r[0],a=r[1],f=r[2];return e[0]=n*f-o*a,e[1]=o*s-i*f,e[2]=i*a-n*s,e}function W(e,t,r,i){var n=[],o=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],o[0]=n[2]*Math.sin(i)+n[0]*Math.cos(i),o[1]=n[1],o[2]=n[2]*Math.cos(i)-n[0]*Math.sin(i),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}var pe=he;(function(){var e=b();return function(t,r,i,n,o,s){var a,f;for(r||(r=3),i||(i=0),n?f=Math.min(n*r+i,t.length):f=t.length,a=i;a<f;a+=r)e[0]=t[a],e[1]=t[a+1],e[2]=t[a+2],o(e,e,s),t[a]=e[0],t[a+1]=e[1],t[a+2]=e[2];return t}})();function me(){var e=new M(4);return M!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function ge(e,t,r,i){var n=new M(4);return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}function ye(e,t){var r=t[0],i=t[1],n=t[2],o=t[3],s=r*r+i*i+n*n+o*o;return s>0&&(s=1/Math.sqrt(s)),e[0]=r*s,e[1]=i*s,e[2]=n*s,e[3]=o*s,e}(function(){var e=me();return function(t,r,i,n,o,s){var a,f;for(r||(r=4),i||(i=0),n?f=Math.min(n*r+i,t.length):f=t.length,a=i;a<f;a+=r)e[0]=t[a],e[1]=t[a+1],e[2]=t[a+2],e[3]=t[a+3],o(e,e,s),t[a]=e[0],t[a+1]=e[1],t[a+2]=e[2],t[a+3]=e[3];return t}})();function V(){var e=new M(4);return M!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function $(e,t,r){r=r*.5;var i=Math.sin(r);return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=Math.cos(r),e}function G(e,t,r,i){var n=t[0],o=t[1],s=t[2],a=t[3],f=r[0],w=r[1],m=r[2],g=r[3],y,l,B,x,z;return l=n*f+o*w+s*m+a*g,l<0&&(l=-l,f=-f,w=-w,m=-m,g=-g),1-l>U?(y=Math.acos(l),B=Math.sin(y),x=Math.sin((1-i)*y)/B,z=Math.sin(i*y)/B):(x=1-i,z=i),e[0]=x*n+z*f,e[1]=x*o+z*w,e[2]=x*s+z*m,e[3]=x*a+z*g,e}function we(e,t){var r=t[0]+t[4]+t[8],i;if(r>0)i=Math.sqrt(r+1),e[3]=.5*i,i=.5/i,e[0]=(t[5]-t[7])*i,e[1]=(t[6]-t[2])*i,e[2]=(t[1]-t[3])*i;else{var n=0;t[4]>t[0]&&(n=1),t[8]>t[n*3+n]&&(n=2);var o=(n+1)%3,s=(n+2)%3;i=Math.sqrt(t[n*3+n]-t[o*3+o]-t[s*3+s]+1),e[n]=.5*i,i=.5/i,e[3]=(t[o*3+s]-t[s*3+o])*i,e[o]=(t[o*3+n]+t[n*3+o])*i,e[s]=(t[s*3+n]+t[n*3+s])*i}return e}var xe=ge,Z=ye;(function(){var e=b(),t=P(1,0,0),r=P(0,1,0);return function(i,n,o){var s=ve(n,o);return s<-.999999?(A(e,t,n),pe(e)<1e-6&&A(e,r,n),E(e,e),$(i,e,Math.PI),i):s>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(A(e,n,o),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=1+s,Z(i,i))}})();(function(){var e=V(),t=V();return function(r,i,n,o,s,a){return G(e,i,s,a),G(t,n,o,a),G(r,e,t,2*a*(1-a)),r}})();(function(){var e=se();return function(t,r,i,n){return e[0]=i[0],e[3]=i[1],e[6]=i[2],e[1]=n[0],e[4]=n[1],e[7]=n[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],Z(t,we(t,e))}})();const q=P(0,1,0);function Y(e,t){const[r,i,n]=t,[o,s,a,f]=e,w=-o*r-s*i-a*n,m=f*r+s*n-a*i,g=f*i+a*r-o*n,y=f*n+o*i-s*r;return xe(m,g,y,w)}const ze={"+":e=>e.position.y+=.1,"-":e=>e.position.y-=.1,z:e=>e.forward(),s:e=>e.backward(),q:e=>e.left(),d:e=>e.right(),a:e=>e.turnLeft(),e:e=>e.turnRight(),r:e=>e.turnUp(),f:e=>e.turnDown()};class J{constructor(){u(this,"position",{x:0,y:0,z:0});u(this,"rotation",{horizontal:0,vertical:0});u(this,"fov",2*Math.PI/5);u(this,"ratio",0);u(this,"near",.5);u(this,"far",1e3);u(this,"keys",{});u(this,"matrix",new Float32Array);u(this,"view",P(1,0,0));document.addEventListener("keypress",t=>{var r,i;if(t.preventDefault(),this.keys[t.key]!=null){(i=(r=this.keys)[t.key])==null||i.call(r,this);const n=new Event("camera");document.dispatchEvent(n)}}),this.keys=ze}forward(t=.1){const r=P(this.view[0],0,this.view[2]);E(r,r),S(r,r,t),this.position.x+=r[0],this.position.z+=r[2]}backward(t=.1){const r=P(this.view[0],0,this.view[2]);E(r,r),S(r,r,t),this.position.x-=r[0],this.position.z-=r[2]}right(t=.1){const r=A(b(),[this.view[0],0,this.view[2]],[0,1,0]);E(r,r),S(r,r,t),this.position.x+=r[0],this.position.z+=r[2]}left(t=.1){const r=A(b(),[this.view[0],0,this.view[2]],[0,1,0]);E(r,r),S(r,r,t),this.position.x-=r[0],this.position.z-=r[2]}turnLeft(t=.1){this.rotation.horizontal=(this.rotation.horizontal+t)%(2*Math.PI),this.view=W(this.view,this.view,[0,0,0],t)}turnRight(t=.1){this.rotation.horizontal=(this.rotation.horizontal-t)%(2*Math.PI),this.view=W(this.view,this.view,[0,0,0],-t)}turnUp(t=.1){if(this.rotation.vertical+t>=Math.PI/2)return;this.rotation.vertical+=t;const r=A(b(),this.view,q);E(r,r);const i=$(V(),r,t*2),n=Y(i,this.view);this.view=P(n[0],n[1],n[2])}turnDown(t=.1){if(this.rotation.vertical-t<=-Math.PI/2)return;this.rotation.vertical-=t;const r=A(b(),this.view,q);E(r,r);const i=$(V(),r,-t*2),n=Y(i,this.view);this.view=P(n[0],n[1],n[2])}updateViewMatrix(){document.getElementById("f3-x").innerText=this.position.x.toString(),document.getElementById("f3-y").innerText=this.position.y.toString(),document.getElementById("f3-z").innerText=this.position.z.toString(),document.getElementById("f3-h").innerText=c.radiansToDegrees(this.rotation.horizontal).toString(),document.getElementById("f3-v").innerText=c.radiansToDegrees(this.rotation.vertical).toString();const t=P(this.position.x,this.position.y,this.position.z),r=de(b(),t,this.view),i=A(b(),this.view,q);E(i,i);const n=A(b(),i,this.view);E(n,n);const o=ue(C(),t,r,n),s=le(C(),this.fov,this.ratio,this.near,this.far);this.matrix=ce(C(),s,o)}}const _={vertex:`
    struct Uniforms {
        viewProjection : mat4x4<f32>,
        translation : vec4<f32>,
        rotation : vec3<f32>,
        scale : vec3<f32>,
    }
    @binding(0) @group(0) var<uniform> uniforms : Uniforms;

    struct VertexOutput {
        @builtin(position) Position : vec4<f32>,
        @location(0) Color : vec4<f32>,
        @location(1) UV : vec2<f32>
    }

    @vertex
    fn main(@location(0) position : vec4<f32>, @location(1) color : vec4<f32>, @location(2) uv : vec2<f32>) -> VertexOutput {
        var output : VertexOutput;
        var scale: mat4x4<f32> = mat4x4<f32>(
            vec4<f32>(uniforms.scale.x, 0.0, 0.0, 0.0),
            vec4<f32>(0.0, uniforms.scale.y, 0.0, 0.0),
            vec4<f32>(0.0, 0.0, uniforms.scale.z, 0.0),
            vec4<f32>(0.0, 0.0, 0.0, 1.0)
        );
        var xRotation: mat4x4<f32> = mat4x4<f32>(
            vec4<f32>(1.0, 0.0, 0.0, 0.0),
            vec4<f32>(0.0, cos(uniforms.rotation.x), sin(uniforms.rotation.x), 0.0),
            vec4<f32>(0.0, -sin(uniforms.rotation.x), cos(uniforms.rotation.x), 0.0),
            vec4<f32>(0.0, 0.0, 0.0, 1.0)
        );
        var yRotation: mat4x4<f32> = mat4x4<f32>(
            vec4<f32>(cos(uniforms.rotation.y), 0.0, -sin(uniforms.rotation.y), 0.0),
            vec4<f32>(0.0, 1.0, 0.0, 0.0),
            vec4<f32>(sin(uniforms.rotation.y), 0.0, cos(uniforms.rotation.y), 0.0),
            vec4<f32>(0.0, 0.0, 0.0, 1.0)
        );
        var zRotation: mat4x4<f32> = mat4x4<f32>(
            vec4<f32>(cos(uniforms.rotation.z), sin(uniforms.rotation.z), 0.0, 0.0),
            vec4<f32>(-sin(uniforms.rotation.z), cos(uniforms.rotation.z), 0.0, 0.0),
            vec4<f32>(0.0, 0.0, 1.0, 0.0),
            vec4<f32>(0.0, 0.0, 0.0, 1.0)
        );
        output.Position = uniforms.viewProjection * (xRotation * yRotation * zRotation * (scale * position) + uniforms.translation);
        output.Color = color;
        output.UV = uv;
        return output;
    }
    `,fragment:`
    @fragment
    fn main(@location(0) Color : vec4<f32>) -> @location(0) vec4<f32> {
        return Color;
    }
    `},Be=4*(16+4+4+4);class Me{constructor(t){u(this,"canvas");u(this,"context");u(this,"device");u(this,"pipeline");u(this,"bufferSize",Be);u(this,"shapes");u(this,"camera",new J);document.addEventListener("camera",()=>this.draw()),this.canvas=t,this.context=t==null?void 0:t.getContext("webgpu"),this.device=null,this.pipeline=null,this.shapes=[]}async initialize(){var r,i,n;const t=await((r=navigator.gpu)==null?void 0:r.requestAdapter());this.device=await(t==null?void 0:t.requestDevice()),this.context.configure({device:this.device,format:(i=navigator.gpu)==null?void 0:i.getPreferredCanvasFormat()}),this.pipeline=this.device.createRenderPipeline({layout:"auto",vertex:{module:this.device.createShaderModule({label:"",code:_.vertex}),entryPoint:"main",buffers:[{arrayStride:4*4,attributes:[{shaderLocation:0,format:"float32x4",offset:0}]},{arrayStride:4*4,attributes:[{shaderLocation:1,format:"float32x4",offset:0}]},{arrayStride:4*2,attributes:[{shaderLocation:2,format:"float32x2",offset:0}]}]},fragment:{module:this.device.createShaderModule({code:_.fragment}),entryPoint:"main",targets:[{format:(n=navigator.gpu)==null?void 0:n.getPreferredCanvasFormat()}]},primitive:{topology:"triangle-list",cullMode:"back"},depthStencil:{depthWriteEnabled:!0,depthCompare:"less",format:"depth24plus"}})}addShape(t){t.add(this),this.shapes.push(t)}draw(){const t=this.device.createTexture({size:[this.canvas.width,this.canvas.height],format:"depth24plus",usage:GPUTextureUsage.RENDER_ATTACHMENT});this.camera.updateViewMatrix();const r=this.device.createCommandEncoder(),i=r.beginRenderPass({colorAttachments:[{view:this.context.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}],depthStencilAttachment:{view:t.createView(),depthClearValue:1,depthLoadOp:"clear",depthStoreOp:"store"}});i.setPipeline(this.pipeline);for(const n of this.shapes)n.draw(this.camera,this.device,i,this.bufferSize);i.end(),this.device.queue.submit([r.finish()])}}let[j,Ee]=oe();document.getElementById("webgpu-check").innerHTML=j;if(!Ee)throw document.getElementById("controls").remove(),document.getElementById("right_overlay").remove(),new Error(j);const T=document.getElementById("canvas-webgpu"),H=document.getElementById("x"),X=document.getElementById("y"),K=document.getElementById("z"),k=document.getElementById("roll"),O=document.getElementById("pitch"),D=document.getElementById("yaw"),L=document.getElementById("scale"),Q=document.getElementById("fov"),R=document.getElementById("toggle");window.onload=async()=>{const e=new Me(T);await e.initialize();const t=new J;t.ratio=T.width/T.height,t.position.x=-3,e.camera=t,window.addEventListener("resize",()=>{t.ratio=T.width/T.height,e.draw()}),R.addEventListener("change",()=>{k.disabled=R.checked,O.disabled=R.checked,D.disabled=R.checked,L.disabled=R.checked});const r=new N;e.addShape(r);for(let s=1;s<10;s++){const a=new N;a.position.z=s,e.addShape(a)}e.draw();function i(){r.position.x=parseFloat(H.value),r.position.y=parseFloat(X.value),r.position.z=parseFloat(K.value),r.rotation.x=c.degreesToRadians(parseFloat(k.value)),r.rotation.y=c.degreesToRadians(parseFloat(O.value)),r.rotation.z=c.degreesToRadians(parseFloat(D.value)),r.scale.x=parseFloat(L.value),r.scale.y=parseFloat(L.value),r.scale.z=parseFloat(L.value),e.draw()}function n(){t.fov=c.degreesToRadians(parseFloat(Q.value)),e.draw()}H.addEventListener("input",i),X.addEventListener("input",i),K.addEventListener("input",i),k.addEventListener("input",i),O.addEventListener("input",i),D.addEventListener("input",i),L.addEventListener("input",i),Q.addEventListener("input",n);function o(){if(R.checked){const s=Date.now()/10%360;r.rotation.x=c.degreesToRadians(s),r.rotation.y=c.degreesToRadians(s),r.rotation.z=c.degreesToRadians(s),r.resize(Math.sin(Date.now()/1e3)+2),e.draw()}requestAnimationFrame(o)}requestAnimationFrame(o)};
